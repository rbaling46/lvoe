<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Question...</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="heart-bg" id="heartBg"></div>

    <!-- Center Graphics -->
    <div class="center-graphics">
        <div class="graphic-sunflower">üåª</div>
        <div class="graphic-heart">‚ù§Ô∏è</div>
    </div>

    <!-- Main Container for steps 1-3 -->
    <div class="container" id="mainContainer">
        <h1 id="questionText">Are you ready?</h1>
        <div class="buttons" id="buttonContainer">
            <button class="btn-yes pulse" onclick="nextStep()">YES</button>
            <button class="btn-no" id="firstNoBtn" onmouseover="moveFirstButton()" onclick="moveFirstButton()">NO</button>
        </div>
    </div>

    <!-- Final Wrapper -->
    <div id="wrapper">
        <h2 id="question">Will you go out with me?</h2>
        <img
             id="gif"
             alt="gif"
             src="https://media.giphy.com/media/FTGah7Mx3ss04PcasF/giphy.gif"
             />
        <div id="btn-group">
          <button id="yes-btn">Yes</button>
          <button id="no-btn">No</button>
        </div>
    </div>

    <script>
        let step = 0;
        const questionText = document.getElementById('questionText');
        const firstNoBtn = document.getElementById('firstNoBtn'); // Renamed to avoid id conflict
        const yesBtn = document.querySelector('.btn-yes');
        const heartBg = document.getElementById('heartBg');
        const container = document.getElementById('mainContainer');
        const finalWrapper = document.getElementById('wrapper');

        // Final screen elements
        const question = document.getElementById("question");
        const gif = document.getElementById("gif");
        const finalYesBtn = document.getElementById("yes-btn");
        const finalNoBtn = document.getElementById("no-btn");

        // Create floating hearts
        function createHearts() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = Math.random() * 3 + 5 + 's';
            
            // Random colors from palette
            const colors = ['#C2103B', '#FF5E24', '#F8DE22', '#ffffff', '#6A0D3D'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            heart.style.setProperty('--heart-color', randomColor);
            
            heartBg.appendChild(heart);
            
            // Remove after animation to prevent DOM overflow
            heart.addEventListener('animationend', () => {
                heart.remove();
            });
        }

        // Start hearts
        const heartInterval = setInterval(createHearts, 300);

        function nextStep() {
            step++;
            
            // Add fade out effect
            questionText.classList.remove('fadelnUp'); // Reset animation
            questionText.classList.add('fade-out');
            
            setTimeout(() => {
                questionText.classList.remove('fade-out');
                questionText.style.animation = 'none';
                questionText.offsetHeight; /* trigger reflow */
                questionText.style.animation = 'fadelnUp 0.8s forwards';

                if (step === 1) {
                    questionText.innerText = "Are you sure?";
                    yesBtn.innerText = "I AM SURE";
                    firstNoBtn.style.position = 'static'; // Reset position logic if needed or keep it running away
                } else if (step === 2) {
                    questionText.innerText = "...of me?";
                    yesBtn.innerText = "YES, OF YOU";
                    // Hide NO button for the romantic part or replace it
                    firstNoBtn.style.display = 'none';
                } else if (step === 3) {
                    // Final state - Transition to new wrapper
                    container.style.display = 'none';
                    finalWrapper.style.display = 'flex';
                }
            }, 500); // Wait for fade out
        }

        function moveFirstButton() {
            // Make the button run away (first part)
            const x = Math.random() * (window.innerWidth - firstNoBtn.offsetWidth - 100);
            const y = Math.random() * (window.innerHeight - firstNoBtn.offsetHeight - 100);
            
            // Ensure it doesn't go off screen (simple check)
            const safeX = Math.max(0, Math.min(x, window.innerWidth - 100));
            const safeY = Math.max(0, Math.min(y, window.innerHeight - 50));

            firstNoBtn.style.position = 'fixed';
            firstNoBtn.style.left = `${safeX}px`;
            firstNoBtn.style.top = `${safeY}px`;
        }

        /* --- Logic for Final Wrapper --- */
        finalYesBtn.addEventListener("click", () => {
            question.innerHTML = "Yay, see you on the 14th of Feb!";
            gif.src = "https://media.giphy.com/media/UMon0fuimoAN9ueUNP/giphy.gif";
            finalNoBtn.style.display = 'none'; // Optional: remove No button after success
        });

        finalNoBtn.addEventListener("mouseover", () => {
            // Calculate random relative movement or absolute?
            // Since the button is absolute inside a relative container, we need to be careful.
            // But the user code used window.innerWidth/Height which implies fixed/absolute to body.
            // Let's modify it to be safe or stick to fixed if we want it to fly anywhere.
            // The CSS I added for #wrapper button makes it absolute within #btn-group (relative).
            // That limits its movement a lot.
            // Let's change position to fixed temporarily to let it fly free, or just keep it relative to the group?
            // Flying free is funnier.
            
            finalNoBtn.style.position = 'absolute'; // Already absolute
            
            const wrapperRect = finalWrapper.getBoundingClientRect();
            const noBtnRect = finalNoBtn.getBoundingClientRect();
            
            // Let's try to keep it inside the wrapper for usability, OR let it roam free.
            // The original code used window.innerWidth.
            
            const maxX = window.innerWidth - noBtnRect.width;
            const maxY = window.innerHeight - noBtnRect.height;
            
            const randomX = Math.floor(Math.random() * maxX);
            const randomY = Math.floor(Math.random() * maxY);

            finalNoBtn.style.position = "fixed"; // Change to fixed to allow full screen movement
            finalNoBtn.style.left = randomX + "px";
            finalNoBtn.style.top = randomY + "px";
        });
    </script>
</body>
</html>
